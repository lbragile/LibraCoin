(this.webpackJsonplibracoin=this.webpackJsonplibracoin||[]).push([[0],{39:function(e,t,a){},40:function(e,t,a){},52:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){},65:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(23),s=a.n(c),i=a(12),l=a(45),o=a(9),u=a(8),d=a.n(u),b=a(6),j=a(10),h=a(69),x=a(71),O=(a(52),a(1));function p(){return Object(O.jsxs)(h.a,{expand:"lg",className:"mb-3",children:[Object(O.jsx)(h.a.Brand,{"aria-label":"LibraCoin Logo",href:"https://github.com/lbragile/LibraCoin",children:Object(O.jsx)("img",{src:"./assets/libracoin-logo-256.png",alt:"LibraCoin Logo",width:"64"})}),Object(O.jsx)(h.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(O.jsx)(h.a.Collapse,{id:"basic-navbar-nav",children:Object(O.jsxs)(x.a,{className:"ml-auto",children:[Object(O.jsx)(x.a.Link,{href:"/LibraCoin/wallet",active:location.href.includes("/wallet"),children:"Wallet"}),Object(O.jsx)(x.a.Link,{href:"/LibraCoin/mine",active:location.href.includes("/mine"),children:"Mine"}),Object(O.jsx)(x.a.Link,{href:"/LibraCoin/blockchain",active:location.href.includes("/blockchain"),children:"Blockchain"})]})})]})}var m,f=a(21),v=a(67),y=a(70),g=r.a.createContext(void 0);function T(e,t,a){e.value.includes("\u25e6")?e.blur():(e.select(),document.execCommand("copy"),a({type:m.ASSIGN_COPIED,payload:{copied:t}}))}function N(e){e({type:m.ASSIGN_COPIED,payload:{copied:""}})}!function(e){e[e.ADD_VERIFIED_TRANS=0]="ADD_VERIFIED_TRANS",e[e.UPDATE_VERIFIED_TRANS=1]="UPDATE_VERIFIED_TRANS",e[e.UPDATE_SELECTED_TRANS=2]="UPDATE_SELECTED_TRANS",e[e.UPDATE_USERS=3]="UPDATE_USERS",e[e.SET_MAIN_USER=4]="SET_MAIN_USER",e[e.ADD_BLOCK=5]="ADD_BLOCK",e[e.UPDATE_BLOCK=6]="UPDATE_BLOCK",e[e.UPDATE_PREVIEW=7]="UPDATE_PREVIEW",e[e.ASSIGN_COPIED=8]="ASSIGN_COPIED"}(m||(m={}));var w=a(44);function S(e){return Array.from(new Uint8Array(e)).map((function(e){return e.toString(16).padStart(2,"0")})).join("")}function k(e,t){return C.apply(this,arguments)}function C(){return(C=Object(j.a)(d.a.mark((function e(t,a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.exportKey(t,a);case 2:return n=e.sent,e.abrupt("return",S(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return P.apply(this,arguments)}function P(){return(P=Object(j.a)(d.a.mark((function e(t){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(new w.TextEncoder).encode(t),e.next=3,window.crypto.subtle.digest("SHA-256",a);case 3:return n=e.sent,e.abrupt("return",S(n));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return S(window.crypto.getRandomValues(new Uint32Array(e)))}a(39);function D(){var e=Object(n.useContext)(g),t=e.state,a=e.dispatch,r=Object(n.useRef)(4),c=Object(n.useState)(!1),s=Object(i.a)(c,2),l=s[0],o=s[1];return Object(n.useEffect)((function(){function e(){return(e=Object(j.a)(d.a.mark((function e(){var n,r,c,s,i,l,o,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.user.privateKey){e.next=17;break}return e.next=3,window.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]);case 3:return n=e.sent,r=n.publicKey,c=n.privateKey,e.next=8,k("spki",r);case 8:return s=e.sent,e.next=11,k("pkcs8",c);case 11:i=e.sent,l=Number(1e3).toFixed(2),o={publicKey:s,privateKey:i,balance:l},a({type:m.SET_MAIN_USER,payload:{user:o}}),u=[].concat(Object(f.a)(t.users),[{publicKey:s,balance:l}]),a({type:m.UPDATE_USERS,payload:{users:u}});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[a,t.user.privateKey,t.users]),Object(O.jsxs)("div",{className:"container-fluid d-flex justify-content-center mx-auto row my-5",children:[Object(O.jsxs)(v.a,{className:"user-key col-12 col-lg-5 pl-3 pl-lg-0",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Public"})}),Object(O.jsx)(y.a.Control,{"aria-label":"publicKey",as:"textarea",rows:r.current,className:"rounded-right",value:t.user.publicKey,isValid:"walletPK"===t.copied,onFocus:function(e){return T(e.target,"walletPK",a)},onBlur:function(){return N(a)},readOnly:!0}),Object(O.jsx)(y.a.Control.Feedback,{type:"valid",children:"Copied to clipboard!"})]}),Object(O.jsxs)(v.a,{className:"user-key col-12 col-lg-5 pl-3",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Private"})}),Object(O.jsx)(y.a.Control,{"aria-label":"privateKey",as:"textarea",rows:r.current,value:l?t.user.privateKey:new Array(t.user.privateKey.length).fill("\u25e6").join(""),onFocus:function(e){return T(e.target,"walletSK",a)},onBlur:function(){return N(a)},isValid:"walletSK"===t.copied,readOnly:!0}),Object(O.jsx)(v.a.Append,{children:Object(O.jsx)(v.a.Text,{className:"rounded-right",children:Object(O.jsx)("span",{id:"private-reveal-eyes",onClick:function(){return o(!l)},children:"\ud83d\udc40"})})}),Object(O.jsx)(y.a.Control.Feedback,{type:"valid",children:"Copied to clipboard!"})]})]})}function R(){var e=Object(n.useContext)(g),t=e.state,a=e.dispatch;return Object(O.jsxs)("div",{className:"container-fluid mb-2",children:[Object(O.jsx)("h3",{className:"font-weight-bold",children:"Users"}),Object(O.jsx)("div",{className:"row flex-nowrap overflow-auto bg-dark mx-1 px-2 rounded",children:t.users.map((function(e,n){return Object(O.jsxs)(y.a,{className:"user-item rounded flex-shrink-0",children:[Object(O.jsxs)(v.a,{children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"\ud83d\udd11"})}),Object(O.jsx)(y.a.Control,{"aria-label":"User Public Key",type:"text",className:"text-truncate rounded-right",onFocus:function(e){return T(e.target,"userItem-"+n,a)},onBlur:function(){return N(a)},defaultValue:e.publicKey,isValid:t.copied==="userItem-"+n,readOnly:!0}),Object(O.jsx)(y.a.Control.Feedback,{type:"valid",children:"Copied to clipboard"})]}),Object(O.jsxs)(v.a,{className:"mt-2",children:[Object(O.jsx)(y.a.Control,{"aria-label":"balance",type:"number",defaultValue:e.balance,disabled:!0}),Object(O.jsx)(v.a.Append,{children:Object(O.jsx)(v.a.Text,{children:"LC"})})]})]},"user-".concat(e.publicKey))}))})]})}var _=a(68);function I(e){var t=e.validated,a=e.signed,r=e.handleSubmit,c=Object(n.useContext)(g).state;return Object(O.jsxs)(y.a,{"aria-label":"Sign Form",noValidate:!0,validated:t,className:"col-12 col-lg-5 trans-form",onSubmit:r,children:[Object(O.jsxs)(v.a,{children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Sender Public Key"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Sender Public Key",name:"sender-pk",className:"text-truncate rounded-right",type:"text",defaultValue:c.user.publicKey,readOnly:!0})]}),Object(O.jsx)(y.a.Text,{className:"text-muted",children:"Used to verify transaction was signed using your private key"}),Object(O.jsxs)(v.a,{className:"my-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Receiver Public Key"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Receiver Public Key",name:"receiver-pk",className:"text-truncate rounded-right",type:"text",pattern:"[A-Za-z0-9]{182,182}",required:!0}),Object(O.jsx)(y.a.Control.Feedback,{type:"invalid",children:Object(O.jsx)("b",{children:"Length or format are incorrect!"})})]}),Object(O.jsxs)(v.a,{className:"mb-2",children:[Object(O.jsx)(y.a.Control,{"aria-label":"Sign Amount",name:"amount",type:"number",step:"any",placeholder:Number(1).toFixed(2),onBlur:function(e){return function(e){e.target.value=Math.min(Math.max(.1,+e.target.value),c.user.balance).toFixed(2)}(e)},required:!0}),Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{className:"rounded-right border-left-0",children:"LC"})})]}),Object(O.jsxs)(v.a,{className:"mb-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Message"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Sign Message",name:"msg",as:"textarea",rows:2,placeholder:"optional message..."})]}),Object(O.jsxs)(v.a,{children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Sender Private Key"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Sender Private Key",name:"sender-sk",className:"text-truncate",type:"text",defaultValue:c.user.privateKey,readOnly:!0})]}),Object(O.jsx)(y.a.Text,{className:"text-muted",children:"Not shared with anyone, keep this secret!"}),Object(O.jsx)(_.a,{"aria-label":"Sign Button",className:"mt-2",variant:"primary",type:"submit",disabled:a,block:!0,children:Object(O.jsx)("b",{children:"Sign"})})]})}function K(e){return Object(O.jsxs)(y.a,{"aria-label":"Send Form",noValidate:!0,className:"col-12 col-lg-5 my-2 my-lg-0 trans-form",onSubmit:function(t){return e.handleSubmit(t)},children:[Object(O.jsxs)(v.a,{children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Receiver Public Key"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Receiver Public Key",name:"receiver-pk",className:"text-truncate",type:"text",defaultValue:e.details.to,readOnly:!0})]}),Object(O.jsx)(y.a.Text,{className:"text-muted",children:"Make sure this matches the value used when signing"}),Object(O.jsxs)(v.a,{className:"my-2",children:[Object(O.jsx)(y.a.Control,{"aria-label":"Send Amount",name:"amount",type:"number",defaultValue:e.details.amount,disabled:!0}),Object(O.jsx)(v.a.Append,{children:Object(O.jsx)(v.a.Text,{className:"rounded-right border-left-0",children:"LC"})})]}),Object(O.jsxs)(v.a,{className:"mb-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Message"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Send Message",name:"msg",as:"textarea",defaultValue:e.details.message,rows:4,placeholder:"optional message...",readOnly:!0})]}),Object(O.jsxs)(v.a,{children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Transaction Signature"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Transaction Signature",name:"sig",type:"text",className:"text-truncate",defaultValue:e.details.signature,readOnly:!0})]}),Object(O.jsx)(y.a.Text,{className:"text-muted",children:"Receiver uses this along with your public key to verify transaction"}),Object(O.jsx)(_.a,{"aria-label":"Send Button",className:"mt-2",variant:"primary",type:"submit",disabled:!e.signed,block:!0,children:Object(O.jsx)("b",{children:"Send"})})]})}function U(){var e,t=Object(n.useContext)(g),a=t.state,r=t.dispatch,c=Object(n.useState)(!1),s=Object(i.a)(c,2),l=s[0],o=s[1],u=Object(n.useState)(!1),h=Object(i.a)(u,2),x=h[0],f=h[1],v=Object(n.useRef)({to:"",from:null!==(e=a.user.publicKey)&&void 0!==e?e:"",amount:void 0,message:"",signature:""}),y=function(){var e=Object(j.a)(d.a.mark((function e(t){var a,n,c,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),o(!0),!(a=t.currentTarget).checkValidity()){e.next=19;break}if(x){e.next=16;break}return n=Object.values(Object(b.a)({},a)).slice(1,4).map((function(e){return e.value})),c=Object(i.a)(n,3),v.current.to=c[0],v.current.amount=c[1],v.current.message=c[2],s=v.current.to+v.current.from+v.current.message+v.current.amount,e.next=13,E(s);case 13:v.current.signature=e.sent,e.next=18;break;case 16:r({type:m.ADD_VERIFIED_TRANS,payload:{trans:v.current}}),o(!1);case 18:f(!x);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(O.jsxs)("div",{children:[Object(O.jsx)(p,{}),Object(O.jsx)(D,{}),Object(O.jsxs)("div",{className:"container-fluid d-flex justify-content-center mx-auto row my-4",children:[Object(O.jsx)(I,{validated:l,signed:x,handleSubmit:y}),Object(O.jsx)(K,{validated:l,signed:x,handleSubmit:y,details:v.current,setSigned:f,setValidated:o})]}),Object(O.jsx)(R,{})]})}a(40);function V(e){var t=Object(n.useContext)(g),a=t.state,c=t.dispatch;return Object(O.jsxs)(y.a,{"aria-label":"Block Form",className:(e.chain?"":"col-10 col-lg-5 ")+"my-4 my-lg-0 p-2 rounded "+(e.chain&&a.chain[e.index].valid||!e.chain&&a.preview.valid?"valid-block":"invalid-block"),children:[Object(O.jsxs)(v.a,{className:"mb-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Index"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Block Index",name:"index",type:"number",value:e.chain?e.index:a.preview.index,disabled:!0})]}),Object(O.jsxs)(v.a,{className:"my-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Timestamp"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Block Timestamp",name:"timestamp",type:"number",value:e.chain?a.chain[e.index].timestamp:a.preview.timestamp,disabled:!0})]}),Object(O.jsxs)(v.a,{className:"my-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Previous #"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Block PrevHash",name:"prevHash",className:"text-truncate",type:"text",value:e.chain&&e.index>0?a.chain[e.index-1].currHash:e.chain?"":a.preview.prevHash,readOnly:!0})]}),Object(O.jsxs)(v.a,{className:"my-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Current #"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Block CurrHash",name:"currHash",className:"text-truncate",type:"text",value:e.chain?a.chain[e.index].currHash:a.preview.currHash,readOnly:!0})]}),Object(O.jsxs)(v.a,{className:"mt-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Merkle #"})}),e.chain&&0===e.index?Object(O.jsx)(y.a.Control,{"aria-label":"Block Merkle Genesis",name:"merkleRoot",type:"text",defaultValue:"",disabled:!0}):Object(O.jsxs)(r.a.Fragment,{children:[Object(O.jsx)(y.a.Control,{"aria-label":"Block Merkle",name:"merkleRoot",className:"text-truncate",type:"text",value:e.chain?a.chain[e.index].merkleRoot:a.preview.merkleRoot,readOnly:!0}),e.chain&&Object(O.jsx)(v.a.Append,{children:Object(O.jsx)(v.a.Text,{"aria-label":"Show Trans",className:"show-trans-eye",onClick:function(){return function(){var t=a.chain[e.index];c({type:m.UPDATE_BLOCK,payload:{block:Object(b.a)(Object(b.a)({},t),{},{showTrans:!t.showTrans})}})}()},children:a.chain[e.index].showTrans?"\ud83d\ude48":"\ud83d\ude49"})})]})]}),!e.chain&&a.preview.valid&&Object(O.jsx)(_.a,{"aria-label":"Add Block",className:"mt-2",variant:"success",block:!0,onClick:function(){return function(){var e=Object(b.a)(Object(b.a)({},a.preview),{},{transactions:a.selectedTrans,valid:a.chain[a.preview.index-1].valid,showTrans:!1}),t={timestamp:Date.now(),index:a.preview.index+1,prevHash:a.preview.currHash,currHash:"",merkleRoot:"",valid:!1};c({type:m.ADD_BLOCK,payload:{block:e}}),c({type:m.UPDATE_VERIFIED_TRANS}),c({type:m.UPDATE_SELECTED_TRANS,payload:{selectedTrans:[]}}),c({type:m.UPDATE_PREVIEW,payload:{preview:t}})}()},children:Object(O.jsx)("h4",{className:"my-0",children:"Add Block"})})]})}var B=a(22);function L(e,t){return M.apply(this,arguments)}function M(){return(M=Object(j.a)(d.a.mark((function e(t,a){var n,r,c,s,i,l,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[[""]],!(a.length>0)){e.next=26;break}r=t.map((function(e){return e.signature})),c=a.map((function(e){return e.signature})),s=r.filter((function(e){return c.includes(e)})),n=[s];case 6:if(1===s.length){e.next=26;break}i=[],l=0;case 9:if(!(l<s.length)){e.next=22;break}if(!s[l+1]){e.next=16;break}return e.next=13,E(s[l]+s[l+1]);case 13:e.t0=e.sent,e.next=17;break;case 16:e.t0=s[l];case 17:o=e.t0,i.push(o);case 19:l+=2,e.next=9;break;case 22:s=i,n.push(i),e.next=6;break;case 26:return e.abrupt("return",n);case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){return e[e.length-1][0]}function F(e,t){t.clear();for(var a=function(e){for(var t=[],a=0;a<e.length;a++)t=t.concat(e[a].reverse());return t}(e),n=a.length-1;n>=0;n--)t.addNode(a[n]);t.drawTree()}function J(e){var t=e.index,a=Object(n.useContext)(g),r=a.state,c=a.dispatch,s=Object(n.useState)(r.chain[t].transactions),l=Object(i.a)(s,2),o=l[0],u=l[1];function h(e,t,a){return x.apply(this,arguments)}function x(){return(x=Object(j.a)(d.a.mark((function e(a,n,s){var i,l,j,h,x,O,p,f,v,y,g;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=JSON.parse(JSON.stringify(o)))[n]=Object(b.a)(Object(b.a)({},i[n]),{},Object(B.a)({},s,a)),l=i[n].to+i[n].from+i[n].amount+i[n].message,e.next=5,E(l);case 5:return i[n].signature=e.sent,u(i),e.next=9,L(i,i);case 9:j=e.sent,h=H(j),x=[],O=Date.now(),p=r.chain[t].prevHash,f="",v=t;case 16:if(!(v<r.chain.length)){e.next=27;break}return y=v===t?i:r.chain[v].transactions,g=v===t?h:r.chain[v].merkleRoot,e.next=21,E(v+p+g);case 21:f=e.sent,x.push(Object(b.a)(Object(b.a)({},r.chain[v]),{},{timestamp:O,prevHash:p,currHash:f,transactions:y,merkleRoot:g,valid:!1})),p=f;case 24:v++,e.next=16;break;case 27:c({type:m.UPDATE_BLOCK,payload:{block:x}});case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(O.jsx)("div",{className:"row flex-nowrap overflow-auto mx-1 p-2 rounded bg-dark",children:o.map((function(e,t){var a;return Object(O.jsxs)("div",{className:(o.length>1&&t!==o.length-1?"mr-2 ":"")+"col-12 bg-light border border-dark p-1 rounded",children:[Object(O.jsxs)(y.a.Group,{className:"mb-2 text-center",children:[Object(O.jsx)(y.a.Control,{className:"text-truncate",type:"text",value:e.from,onChange:function(e){return h(e.target.value,t,"from")}}),Object(O.jsx)("h3",{className:"my-0",children:"\u2193"}),Object(O.jsx)(y.a.Control,{className:"text-truncate",type:"text",value:e.to,onChange:function(e){return h(e.target.value,t,"to")}})]}),Object(O.jsxs)(v.a,{className:"mb-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Msg"})}),Object(O.jsx)(y.a.Control,{as:"textarea",rows:3,value:e.message,onChange:function(e){return h(e.target.value,t,"message")}})]}),Object(O.jsxs)(v.a,{className:"mb-2",children:[Object(O.jsx)(y.a.Control,{type:"number",value:null!==(a=e.amount)&&void 0!==a?a:0,onChange:function(e){return h(e.target.value,t,"amount")}}),Object(O.jsx)(v.a.Append,{children:Object(O.jsx)(v.a.Text,{children:"LC"})})]}),Object(O.jsxs)(v.a,{children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Sig"})}),Object(O.jsx)(y.a.Control,{className:"text-truncate",type:"text",defaultValue:e.signature,readOnly:!0},e.signature)]})]},"sig:".concat(t))}))})}function W(e){var t=Object(n.useContext)(g),a=t.state,r=t.dispatch,c=Object(n.useRef)(0),s=Object(n.useState)(0),l=Object(i.a)(s,2),o=l[0],u=l[1],h=Object(n.useState)(""),x=Object(i.a)(h,2),p=x[0],f=x[1],T=Object(n.useState)(""),N=Object(i.a)(T,2),w=N[0],S=N[1],k=Object(n.useState)(!1),C=Object(i.a)(k,2),P=C[0],D=C[1];function R(){return(R=Object(j.a)(d.a.mark((function t(){var n,s,i,l,o,j,h,x,O,p,v,y,g,T,N,w;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chain,s=e.index,D(!0),c.current=Math.round(1e6*Math.random()),i=Math.round(Math.random())+2,l=new RegExp("^.{0,".concat(i,"}"),"g"),o=new Array(i).fill("0").join(""),t.next=8,E(A(20));case 8:j=(j=t.sent).replace(l,o),f(j),h="",x=c.current;case 13:if(!(x<=Number.MAX_SAFE_INTEGER)){t.next=24;break}return t.next=16,E(x.toString());case 16:if(h=t.sent,S(h),u(x++),O=new RegExp("^0{".concat(i,"}")),!h.match(O)){t.next=22;break}return t.abrupt("break",24);case 22:t.next=13;break;case 24:if(D(!1),p=Date.now(),v=Object(B.a)({},n?"block":"preview",Object(b.a)(Object(b.a)({},n?a.chain[s]:a.preview),{},{timestamp:p,prevHash:a.chain[(n?s:a.preview.index)-1].currHash,currHash:h,valid:h<=j})),y=n?m.UPDATE_BLOCK:m.UPDATE_PREVIEW,r({type:y,payload:v}),!n){t.next=44;break}g=[],T=h,N="",w=s+1;case 34:if(!(w<a.chain.length)){t.next=43;break}return t.next=37,E(w+T+a.chain[w].merkleRoot);case 37:N=t.sent,g.push(Object(b.a)(Object(b.a)({},a.chain[w]),{},{timestamp:p,prevHash:T,currHash:N,valid:!1})),T=N;case 40:w++,t.next=34;break;case 43:g.length&&r({type:m.UPDATE_BLOCK,payload:{block:g}});case 44:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(O.jsxs)(y.a,{"aria-label":"Block Statistics",className:e.chain?"my-3":"col-11 col-lg-5 mx-3",children:[Object(O.jsxs)(v.a,{className:"my-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Nonce"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Block Nonce",name:"nonce",type:"number",defaultValue:c.current,disabled:!0},c.current)]}),Object(O.jsxs)(v.a,{className:"my-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Header"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Block Header",name:"header",type:"number",value:o,disabled:!0})]}),Object(O.jsxs)(v.a,{className:"my-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Target"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Block Target",name:"target",className:"text-truncate",type:"text",value:p,readOnly:!0})]}),Object(O.jsxs)(v.a,{className:"my-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Sol'n"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Block Solution",name:"solution",className:"text-truncate "+(e.chain&&a.chain[e.index].valid||!e.chain&&a.preview.valid?"valid-solution":"invalid-solution"),type:"text",value:w,readOnly:!0})]}),Object(O.jsx)(_.a,{"aria-label":"Block Mine",variant:"primary",className:"btn-block mt-2 py-2",disabled:e.chain&&a.chain[e.index].valid||!e.chain&&(a.preview.valid||0===a.selectedTrans.length)||P,onClick:function(){return function(){return R.apply(this,arguments)}()},children:Object(O.jsxs)("h4",{className:"my-0 row justify-content-end flex-nowrap",children:[Object(O.jsx)("span",{className:"col-10 pl-5",children:"Mine"}),Object(O.jsx)("span",{className:"spinner-border spinner-border-md mr-3 "+(P?"visible":"invisible"),role:"status"})]})})]})}function G(){var e=Object(n.useContext)(g).state;return Object(O.jsxs)("div",{children:[Object(O.jsx)(p,{}),Object(O.jsx)("div",{className:"mx-3 row flex-nowrap overflow-auto",children:e.chain.map((function(e){return Object(O.jsxs)("div",{className:"block mx-2 flex-column flex-shrink-0",children:[Object(O.jsx)(V,{chain:!0,index:e.index}),Object(O.jsx)(W,{chain:!0,index:e.index}),e.showTrans&&Object(O.jsx)(J,{index:e.index})]},e.prevHash)}))})]})}a(59);function q(){var e=Object(n.useContext)(g),t=e.state,a=e.dispatch;function r(){return(r=Object(j.a)(d.a.mark((function e(n){var r,c,s,i,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=JSON.parse(JSON.stringify(t.selectedTrans)),c=r.map((function(e){return e.signature})),s=c.includes(n.signature),!(r.length<4||s)){e.next=13;break}return s?r=r.filter((function(e){return e.signature!==n.signature})):r.push(n),e.next=7,L(t.verifiedTrans,r);case 7:i=e.sent,l=Object(b.a)(Object(b.a)({},t.preview),{},{merkleRoot:H(i),valid:!1}),a({type:m.UPDATE_SELECTED_TRANS,payload:{selectedTrans:r}}),a({type:m.UPDATE_PREVIEW,payload:{preview:l}}),e.next=14;break;case 13:alert("You can mine at most 4 transactions at a time!");case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(O.jsxs)("div",{className:"container-fluid",children:[Object(O.jsx)("h3",{"aria-label":"Title",className:"font-weight-bold",children:"Verified Transactions"}),Object(O.jsx)("div",{className:"trans-list row flex-nowrap overflow-auto bg-dark mx-1 px-2 rounded",children:t.verifiedTrans.map((function(e){return Object(O.jsxs)(y.a,{"aria-label":"Transaction Information",className:"trans-item "+(t.selectedTrans.map((function(e){return e.signature})).includes(e.signature)?"selected":"not-selected"),onClick:function(){return function(e){return r.apply(this,arguments)}(e)},children:[Object(O.jsxs)(y.a.Group,{className:"mb-2 text-center",children:[Object(O.jsx)(y.a.Control,{"aria-label":"Transaction From",name:"from",className:"text-truncate",type:"text",defaultValue:e.from,readOnly:!0}),Object(O.jsx)("h3",{className:"my-0",children:"\u2193"}),Object(O.jsx)(y.a.Control,{"aria-label":"Transaction To",name:"to",className:"text-truncate",type:"text",defaultValue:e.to,readOnly:!0})]}),Object(O.jsxs)(v.a,{className:"mb-2",children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Msg"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Transaction Message",name:"message",as:"textarea",defaultValue:e.message,readOnly:!0})]}),Object(O.jsxs)(v.a,{className:"mb-2",children:[Object(O.jsx)(y.a.Control,{"aria-label":"Transaction Amount",name:"amount",type:"number",defaultValue:e.amount,disabled:!0}),Object(O.jsx)(v.a.Append,{children:Object(O.jsx)(v.a.Text,{children:"LC"})})]}),Object(O.jsxs)(v.a,{children:[Object(O.jsx)(v.a.Prepend,{children:Object(O.jsx)(v.a.Text,{children:"Sig"})}),Object(O.jsx)(y.a.Control,{"aria-label":"Transaction Signature",name:"signature",className:"text-truncate",type:"text",defaultValue:e.signature,readOnly:!0})]})]},"sig:".concat(e.signature))}))})]})}var z=a(7),X=a(24),Y=a(35),Z=a(36),Q=function(){function e(t){Object(Y.a)(this,e),this.value=void 0,this.children=void 0,this.parent=void 0,this.pos=void 0,this.value=t,this.children=[],this.parent=null,this.pos={x:0,y:0}}return Object(Z.a)(e,[{key:"left",get:function(){return this.children[0]},set:function(e){e.parent=this,this.children[0]=e}},{key:"right",get:function(){return this.children[1]},set:function(e){e.parent=this,this.children[1]=e}},{key:"position",get:function(){return this.pos},set:function(e){this.pos=e}}]),e}(),$=Object(X.a)("root"),ee=Object(X.a)("transactionSignatures"),te=Object(X.a)("startPosition"),ae=Object(X.a)("dim"),ne=Object(X.a)("ctx"),re=function(){function e(t,a){Object(Y.a)(this,e),Object.defineProperty(this,$,{writable:!0,value:void 0}),Object.defineProperty(this,ee,{writable:!0,value:void 0}),Object.defineProperty(this,te,{writable:!0,value:void 0}),Object.defineProperty(this,ae,{writable:!0,value:void 0}),Object.defineProperty(this,ne,{writable:!0,value:void 0});var n=window.innerWidth<1200?1.8*window.innerWidth:window.innerWidth/2*.7;Object(z.a)(this,$)[$]=null,Object(z.a)(this,ee)[ee]=a.map((function(e){return e.signature.slice(0,25)+"..."})),Object(z.a)(this,te)[te]={x:n,y:5},Object(z.a)(this,ne)[ne]=t.getContext("2d"),Object(z.a)(this,ae)[ae]={width:t.width,height:t.height}}return Object(Z.a)(e,[{key:"calculatePosition",value:function(e){var t=e.x,a=e.y,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=50;return{x:n?t-6*r:t+6*r,y:a+r}}},{key:"clear",value:function(){Object(z.a)(this,ne)[ne]&&Object(z.a)(this,ne)[ne].clearRect(0,0,Object(z.a)(this,ae)[ae].width,Object(z.a)(this,ae)[ae].height)}},{key:"addNode",value:function(e){var t=new Q(""!==e?e.slice(0,25)+"...":"");if(Object(z.a)(this,$)[$])for(var a=Object(z.a)(this,$)[$];a;){if(!a.left){t.position=this.calculatePosition(a.position,!0),a.left=t;break}if(!a.right){t.position=this.calculatePosition(a.position),a.right=t;break}a=a.left.left&&a.left.right?a.right:a.left}else t.position=Object(z.a)(this,te)[te],Object(z.a)(this,$)[$]=t}},{key:"drawTree",value:function(){var e=this,t=[];for(t.push(Object(z.a)(this,$)[$]);0!==t.length;){var a=t.shift(),n=a&&9*a.value.length;Object(z.a)(this,ne)[ne]&&n&&a&&function(){var r,c=a.position,s=c.x,i=c.y;Object(z.a)(e,ne)[ne].beginPath(),Object(z.a)(e,ne)[ne].font="1rem Arial",Object(z.a)(e,ne)[ne].strokeStyle="#000";var l=Object(z.a)(e,ee)[ee].includes(a.value)?"#ddf":"#ff0a";Object(z.a)(e,ne)[ne].fillStyle=a.value===(null===(r=Object(z.a)(e,$)[$])||void 0===r?void 0:r.value)?"#dfd":l,Object(z.a)(e,ne)[ne].fillRect(s-n/2,i+5,n,30),Object(z.a)(e,ne)[ne].fillStyle="#000",Object(z.a)(e,ne)[ne].fillText(a.value,s+10-n/2,i+27),a.children.forEach((function(a,n){a.position.x=1===n?a.position.x-150:a.position.x+150,t.push(a),Object(z.a)(e,ne)[ne]&&(Object(z.a)(e,ne)[ne].beginPath(),Object(z.a)(e,ne)[ne].moveTo(s+.5,i+35),Object(z.a)(e,ne)[ne].lineTo(a.position.x+.5,a.position.y+5),Object(z.a)(e,ne)[ne].stroke())}))}()}}}]),e}();function ce(){var e=Object(n.useContext)(g).state,t=Object(n.useRef)(null);return Object(n.useEffect)((function(){function a(){return(a=Object(j.a)(d.a.mark((function a(){var n,r;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.current){a.next=6;break}return a.next=3,L(e.verifiedTrans,e.selectedTrans);case 3:n=a.sent,r=new re(t.current,e.selectedTrans),F(n,r);case 6:case"end":return a.stop()}}),a)})))).apply(this,arguments)}!function(){a.apply(this,arguments)}()}),[e.selectedTrans,e.verifiedTrans]),Object(O.jsxs)("div",{className:"mb-2 d-none d-lg-block",children:[Object(O.jsx)("h4",{className:"font-weight-bold text-center",children:"Merkle Tree Visualization"}),Object(O.jsx)("canvas",{ref:t,className:"border border-dark rounded",width:.7*window.outerWidth})]})}function se(){return Object(O.jsxs)("div",{children:[Object(O.jsx)(p,{}),Object(O.jsx)(q,{}),Object(O.jsxs)("div",{className:"container-fluid row d-flex justify-content-center mx-auto my-3",children:[Object(O.jsx)(ce,{}),Object(O.jsx)(W,{chain:!1,index:0}),Object(O.jsx)(V,{chain:!1,index:0})]})]})}var ie=function(e,t){switch(t.type){case m.ADD_VERIFIED_TRANS:var a=t.payload.trans,n=[].concat(Object(f.a)(e.verifiedTrans),[Object(b.a)({},a)]);return localStorage.setItem("verTrans",JSON.stringify(n,null,2)),Object(b.a)(Object(b.a)({},e),{},{verifiedTrans:n});case m.UPDATE_VERIFIED_TRANS:var r=e.selectedTrans.map((function(e){return e.signature})),c=e.verifiedTrans.filter((function(e){return!r.includes(e.signature)}));return localStorage.setItem("verTrans",JSON.stringify(c,null,2)),Object(b.a)(Object(b.a)({},e),{},{verifiedTrans:c});case m.UPDATE_SELECTED_TRANS:var s=t.payload.selectedTrans;return localStorage.setItem("selTrans",JSON.stringify(s,null,2)),Object(b.a)(Object(b.a)({},e),{},{selectedTrans:s});case m.UPDATE_USERS:var i=t.payload.users;return localStorage.setItem("users",JSON.stringify(i,null,2)),Object(b.a)(Object(b.a)({},e),{},{users:i});case m.SET_MAIN_USER:var l=t.payload.user;return localStorage.setItem("user",JSON.stringify(l,null,2)),Object(b.a)(Object(b.a)({},e),{},{user:l});case m.ADD_BLOCK:var o=t.payload.block,u=[].concat(Object(f.a)(e.chain),[Object(b.a)({},o)]);return localStorage.setItem("chain",JSON.stringify(u,null,2)),Object(b.a)(Object(b.a)({},e),{},{chain:u});case m.UPDATE_BLOCK:var d=t.payload.block,j=Array.isArray(d)?Object(f.a)(d):[d],h=Object(f.a)(e.chain);return j.forEach((function(e){return h[e.index]=Object(b.a)({},e)})),localStorage.setItem("chain",JSON.stringify(h,null,2)),Object(b.a)(Object(b.a)({},e),{},{chain:h});case m.UPDATE_PREVIEW:var x=t.payload.preview;return localStorage.setItem("preview",JSON.stringify(x,null,2)),Object(b.a)(Object(b.a)({},e),{},{preview:Object(b.a)({},x)});case m.ASSIGN_COPIED:var O=t.payload.copied;return localStorage.setItem("copied",O),Object(b.a)(Object(b.a)({},e),{},{copied:O});default:return e}};a(60);function le(){var e,t,a,r,c,s,u=Object(n.useReducer)(ie,{verifiedTrans:null!==(e=JSON.parse(localStorage.getItem("verTrans")))&&void 0!==e?e:[],selectedTrans:null!==(t=JSON.parse(localStorage.getItem("selTrans")))&&void 0!==t?t:[],users:null!==(a=JSON.parse(localStorage.getItem("users")))&&void 0!==a?a:[],user:null!==(r=JSON.parse(localStorage.getItem("user")))&&void 0!==r?r:{publicKey:"",privateKey:"",balance:1e3},chain:null!==(c=JSON.parse(localStorage.getItem("chain")))&&void 0!==c?c:[{index:0,prevHash:"",currHash:new Array(64).fill("0").join(""),transactions:[],timestamp:Date.parse("31 Apr 2021 00:00:00 UTC"),merkleRoot:"",valid:!0}],copied:"",preview:null!==(s=JSON.parse(localStorage.getItem("preview")))&&void 0!==s?s:{index:1,prevHash:new Array(64).fill("0").join(""),currHash:"",transactions:[],timestamp:Date.parse("31 Apr 2021 00:00:00 UTC"),merkleRoot:"",valid:!1}}),d=Object(i.a)(u,2),b=d[0],j=d[1],h=Object(n.useMemo)((function(){return{state:b,dispatch:j}}),[b,j]);return Object(O.jsx)(l.a,{basename:"/LibraCoin",children:Object(O.jsxs)(g.Provider,{value:h,children:[Object(O.jsx)(o.b,{exact:!0,path:"/",children:Object(O.jsx)(o.a,{to:"/wallet"})}),Object(O.jsx)(o.b,{path:"/wallet",component:U}),Object(O.jsx)(o.b,{path:"/mine",component:se}),Object(O.jsx)(o.b,{path:"/blockchain",component:G})]})})}a(64);s.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(le,{})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.315cd919.chunk.js.map