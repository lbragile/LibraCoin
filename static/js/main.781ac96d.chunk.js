(this.webpackJsonplibracoin=this.webpackJsonplibracoin||[]).push([[0],{39:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){},52:function(e,t,a){},60:function(e,t,a){},65:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(21),s=a.n(c),i=a(8),l=a(46),o=a(10),u=a(69),d=a(71),j=(a(52),a(1));function b(){return Object(j.jsxs)(u.a,{expand:"lg",className:"mb-3",children:[Object(j.jsx)(u.a.Brand,{"aria-label":"LibraCoin Logo",href:"https://github.com/lbragile/LibraCoin",children:Object(j.jsx)("img",{src:"./assets/libracoin-logo-256.png",alt:"LibraCoin Logo",width:"64"})}),Object(j.jsx)(u.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(j.jsx)(u.a.Collapse,{id:"basic-navbar-nav",children:Object(j.jsxs)(d.a,{className:"ml-auto",children:[Object(j.jsx)(d.a.Link,{href:"/LibraCoin/wallet",active:location.href.includes("/wallet"),children:"Wallet"}),Object(j.jsx)(d.a.Link,{href:"/LibraCoin/mine",active:location.href.includes("/mine"),children:"Mine"}),Object(j.jsx)(d.a.Link,{href:"/LibraCoin/blockchain",active:location.href.includes("/blockchain"),children:"Blockchain"})]})})]})}var x,h=a(7),O=a.n(h),p=a(24),f=a(11),m=a(67),v=a(70),y=r.a.createContext(void 0);function g(e,t,a,n,r){var c=!e.target.value.includes("\u25e6");if(c?(e.target.select(),document.execCommand("copy")):e.target.blur(),a){var s="public"===a;t([s,!s&&c])}else{var i=new Array(r).fill(!1);i[n]=!0,t(i)}}!function(e){e[e.ADD_VERIFIED_TRANS=0]="ADD_VERIFIED_TRANS",e[e.UPDATE_VERIFIED_TRANS=1]="UPDATE_VERIFIED_TRANS",e[e.UPDATE_SELECTED_TRANS=2]="UPDATE_SELECTED_TRANS",e[e.UPDATE_USERS=3]="UPDATE_USERS",e[e.SET_MAIN_USER=4]="SET_MAIN_USER",e[e.ADD_BLOCK=5]="ADD_BLOCK",e[e.UPDATE_BLOCK=6]="UPDATE_BLOCK"}(x||(x={}));var N=a(45);function T(e){return Array.from(new Uint8Array(e)).map((function(e){return e.toString(16).padStart(2,"0")})).join("")}function S(e,t){return k.apply(this,arguments)}function k(){return(k=Object(f.a)(O.a.mark((function e(t,a){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.exportKey(t,a);case 2:return n=e.sent,e.abrupt("return",T(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return C.apply(this,arguments)}function C(){return(C=Object(f.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(new N.TextEncoder).encode(t),e.next=3,window.crypto.subtle.digest("SHA-256",a);case 3:return n=e.sent,e.abrupt("return",T(n));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return T(window.crypto.getRandomValues(new Uint32Array(e)))}a(39);function P(){var e,t,a,r=Object(n.useContext)(y),c=r.state,s=r.dispatch,l=Object(n.useRef)(4),o=Object(n.useRef)(null),u=Object(n.useRef)(null),d=Object(n.useState)([!1,!1]),b=Object(i.a)(d,2),h=b[0],N=b[1];Object(n.useEffect)((function(){function e(){return(e=Object(f.a)(O.a.mark((function e(){var t,a,n,r,i,l,d,j;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.user.publicKey){e.next=18;break}return e.next=3,window.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]);case 3:return t=e.sent,a=t.publicKey,n=t.privateKey,e.next=8,S("spki",a);case 8:return r=e.sent,e.next=11,S("pkcs8",n);case 11:i=e.sent,o.current&&u.current&&(o.current.innerText=r,u.current.innerText=new Array(i.length).fill("\u25e6").join("")),l=Number(1e3).toFixed(2),d={publicKey:r,privateKey:i,balance:l},s({type:x.SET_MAIN_USER,payload:{user:d}}),j=[].concat(Object(p.a)(c.users),[{publicKey:r,balance:l}]),s({type:x.UPDATE_USERS,payload:{users:j}});case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[s,c.user.publicKey,c.users]);return Object(j.jsxs)("div",{className:"container-fluid d-flex justify-content-center mx-auto row my-5",children:[Object(j.jsxs)(m.a,{className:"user-key col-12 col-lg-5 pl-3 pl-lg-0",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Public"})}),Object(j.jsx)(v.a.Control,{"aria-label":"publicKey",as:"textarea",rows:l.current,className:"rounded-right",defaultValue:null!==(e=null===(t=c.user)||void 0===t?void 0:t.publicKey)&&void 0!==e?e:"",isValid:h[0],onFocus:function(e){return g(e,N,"public")},onBlur:function(){return N([!1,!1])},readOnly:!0,ref:o}),Object(j.jsx)(v.a.Control.Feedback,{type:"valid",children:"Copied to clipboard!"})]}),Object(j.jsxs)(m.a,{className:"user-key col-12 col-lg-5 pl-3",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Private"})}),Object(j.jsx)(v.a.Control,{"aria-label":"privateKey",as:"textarea",rows:l.current,defaultValue:(null===(a=c.user)||void 0===a?void 0:a.privateKey)?new Array(c.user.privateKey.length).fill("\u25e6").join(""):"",onFocus:function(e){return g(e,N,"private")},onBlur:function(){return N([!1,!1])},isValid:h[1],readOnly:!0,ref:u}),Object(j.jsx)(m.a.Append,{children:Object(j.jsx)(m.a.Text,{className:"rounded-right",children:Object(j.jsx)("span",{id:"private-reveal-eyes",onClick:function(){var e,t=null===(e=u.current)||void 0===e?void 0:e.value.includes("\u25e6"),a=new Array(c.user.privateKey.length).fill("\u25e6").join("");u.current.value=t?c.user.privateKey:a},children:"\ud83d\udc40"})})}),Object(j.jsx)(v.a.Control.Feedback,{type:"valid",children:"Copied to clipboard!"})]})]})}var A=a(9),D=a(68);function R(e){return Object(j.jsxs)(v.a,{"aria-label":"Send Form",noValidate:!0,className:"col-12 col-lg-5 my-2 my-lg-0 trans-form",onSubmit:function(t){return e.handleSubmit(t)},children:[Object(j.jsxs)(m.a,{children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Receiver Public Key"})}),Object(j.jsx)(v.a.Control,{"aria-label":"Receiver Public Key",name:"receiver-pk",className:"text-truncate",type:"text",defaultValue:e.details.to,readOnly:!0})]}),Object(j.jsx)(v.a.Text,{className:"text-muted",children:"Make sure this matches the value used when signing"}),Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(v.a.Control,{"aria-label":"Send Amount",name:"amount",type:"number",defaultValue:e.details.amount,disabled:!0}),Object(j.jsx)(m.a.Append,{children:Object(j.jsx)(m.a.Text,{className:"rounded-right border-left-0",children:"LC"})})]}),Object(j.jsxs)(m.a,{className:"mb-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Message"})}),Object(j.jsx)(v.a.Control,{"aria-label":"Send Message",name:"msg",as:"textarea",defaultValue:e.details.message,rows:4,placeholder:"optional message...",readOnly:!0})]}),Object(j.jsxs)(m.a,{children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Transaction Signature"})}),Object(j.jsx)(v.a.Control,{"aria-label":"Transaction Signature",name:"sig",type:"text",className:"text-truncate",defaultValue:e.details.signature,readOnly:!0})]}),Object(j.jsx)(v.a.Text,{className:"text-muted",children:"Receiver uses this along with your public key to verify transaction"}),Object(j.jsx)(D.a,{"aria-label":"Send Button",className:"mt-2",variant:"primary",type:"submit",disabled:!e.signed,block:!0,children:Object(j.jsx)("b",{children:"Send"})})]})}function V(e){var t,a,r=e.validated,c=e.signed,s=e.handleSubmit,i=Object(n.useContext)(y).state;return Object(j.jsxs)(v.a,{"aria-label":"Sign Form",noValidate:!0,validated:r,className:"col-12 col-lg-5 trans-form",onSubmit:s,children:[Object(j.jsxs)(m.a,{children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Sender Public Key"})}),Object(j.jsx)(v.a.Control,{"aria-label":"Sender Public Key",name:"sender-pk",className:"text-truncate rounded-right",type:"text",defaultValue:null!==(t=i.user.publicKey)&&void 0!==t?t:"",readOnly:!0})]}),Object(j.jsx)(v.a.Text,{className:"text-muted",children:"Used to verify transaction was signed using your private key"}),Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Receiver Public Key"})}),Object(j.jsx)(v.a.Control,{"aria-label":"Receiver Public Key",name:"receiver-pk",className:"text-truncate rounded-right",type:"text",pattern:"[A-Za-z0-9]{182,182}",required:!0}),Object(j.jsx)(v.a.Control.Feedback,{type:"invalid",children:Object(j.jsx)("b",{children:"Length or format are incorrect!"})})]}),Object(j.jsxs)(m.a,{className:"mb-2",children:[Object(j.jsx)(v.a.Control,{"aria-label":"Sign Amount",name:"amount",type:"number",step:"any",placeholder:Number(1).toFixed(2),onBlur:function(e){return function(e){var t,a=null!==(t=i.user.balance)&&void 0!==t?t:1e3;e.target.value=Math.min(Math.max(.1,+e.target.value),a).toFixed(2)}(e)},required:!0}),Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{className:"rounded-right border-left-0",children:"LC"})})]}),Object(j.jsxs)(m.a,{className:"mb-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Message"})}),Object(j.jsx)(v.a.Control,{"aria-label":"Sign Message",name:"msg",as:"textarea",rows:2,placeholder:"optional message..."})]}),Object(j.jsxs)(m.a,{children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Sender Private Key"})}),Object(j.jsx)(v.a.Control,{"aria-label":"Sender Private Key",name:"sender-sk",className:"text-truncate",type:"text",defaultValue:null!==(a=i.user.privateKey)&&void 0!==a?a:"",readOnly:!0})]}),Object(j.jsx)(v.a.Text,{className:"text-muted",children:"Not shared with anyone, keep this secret!"}),Object(j.jsx)(D.a,{"aria-label":"Sign Button",className:"mt-2",variant:"primary",type:"submit",disabled:c,block:!0,children:Object(j.jsx)("b",{children:"Sign"})})]})}a(40);function _(){var e,t=Object(n.useContext)(y),a=t.state,r=t.dispatch,c=Object(n.useState)(!1),s=Object(i.a)(c,2),l=s[0],o=s[1],u=Object(n.useState)(!1),d=Object(i.a)(u,2),b=d[0],h=d[1],p=Object(n.useRef)({to:"",from:null!==(e=a.user.publicKey)&&void 0!==e?e:"",amount:void 0,message:"",signature:""}),m=function(){var e=Object(f.a)(O.a.mark((function e(t){var a,n,c,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),o(!0),!(a=t.currentTarget).checkValidity()){e.next=19;break}if(b){e.next=16;break}return n=Object.values(Object(A.a)({},a)).slice(1,4).map((function(e){return e.value})),c=Object(i.a)(n,3),p.current.to=c[0],p.current.amount=c[1],p.current.message=c[2],s=p.current.to+p.current.from+p.current.message+p.current.amount,e.next=13,w(s);case 13:p.current.signature=e.sent,e.next=18;break;case 16:r({type:x.ADD_VERIFIED_TRANS,payload:{trans:p.current}}),o(!1);case 18:h(!b);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsxs)("div",{className:"container-fluid d-flex justify-content-center mx-auto row my-4",children:[Object(j.jsx)(V,{validated:l,signed:b,handleSubmit:m}),Object(j.jsx)(R,{validated:l,signed:b,handleSubmit:m,details:p.current,setSigned:h,setValidated:o})]})}function I(){var e,t=Object(n.useContext)(y).state,a=Object(n.useState)(new Array(t.users.length).fill(!1)),r=Object(i.a)(a,2),c=r[0],s=r[1];return Object(j.jsxs)("div",{className:"container-fluid mb-2",children:[Object(j.jsx)("h3",{className:"font-weight-bold",children:"Users"}),Object(j.jsx)("div",{className:"row flex-nowrap overflow-auto bg-dark mx-1 px-2 rounded",children:null===(e=t.users)||void 0===e?void 0:e.map((function(e,a){return Object(j.jsxs)(v.a,{className:"user-item rounded flex-shrink-0",children:[Object(j.jsxs)(m.a,{children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"\ud83d\udd11"})}),Object(j.jsx)(v.a.Control,{"aria-label":"User Public Key",type:"text",className:"text-truncate rounded-right",onFocus:function(e){return g(e,s,void 0,a,t.users.length)},onBlur:function(){return function(e){var t=JSON.parse(JSON.stringify(c));t[e]=!1,s(t)}(a)},defaultValue:e.publicKey,isValid:c[a],readOnly:!0}),Object(j.jsx)(v.a.Control.Feedback,{type:"valid",children:"Copied to clipboard"})]}),Object(j.jsxs)(m.a,{className:"mt-2",children:[Object(j.jsx)(v.a.Control,{"aria-label":"balance",type:"number",defaultValue:e.balance,disabled:!0}),Object(j.jsx)(m.a.Append,{children:Object(j.jsx)(m.a.Text,{children:"LC"})})]})]},"user-".concat(e.publicKey))}))})]})}function K(){return Object(j.jsxs)("div",{children:[Object(j.jsx)(b,{}),Object(j.jsx)(P,{}),Object(j.jsx)(_,{}),Object(j.jsx)(I,{})]})}function L(e){return U.apply(this,arguments)}function U(){return(U=Object(f.a)(O.a.mark((function e(t){var a,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(E(20));case 2:return a=e.sent,n=new RegExp("^.{0,".concat(t,"}"),"g"),r=Array(t).fill("0").join(""),e.abrupt("return",a.replace(n,r));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t,a,n,r){return F.apply(this,arguments)}function F(){return(F=Object(f.a)(O.a.mark((function e(t,a,n,r,c){var s,i,l,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Math.round(Math.random())+2,e.next=3,L(s);case 3:i=e.sent,n(i),l="",o=t;case 7:if(!(o<=Number.MAX_SAFE_INTEGER)){e.next=18;break}return e.next=10,w(o.toString());case 10:if(l=e.sent,r(l),a(o++),!l.substr(0,s).split("").every((function(e){return"0"===e}))){e.next=16;break}return e.abrupt("break",18);case 16:e.next=7;break;case 18:return c(l<=i),e.abrupt("return",l);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t,a,n,r,c,s,i){return B.apply(this,arguments)}function B(){return(B=Object(f.a)(O.a.mark((function e(t,a,n,r,c,s,i,l){var o,u,d,j,b,h,p,f=arguments;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=f.length>8&&void 0!==f[8]?f[8]:Date.now(),u=[],d=n;case 3:if(!(d<t.chain.length)){e.next=21;break}if(b=i&&d===n?i:t.chain[d].merkleRoot,h=s&&d===n,p=null!==(j=t.chain[d].showTrans)&&void 0!==j&&j,d!==n){e.next=11;break}e.t0=c,e.next=14;break;case 11:return e.next=13,w(d+r+b);case 13:e.t0=e.sent;case 14:c=e.t0,l=d===n&&l?l:t.chain[d].transactions,u.push({index:d,timestamp:o,prevHash:r,currHash:c,transactions:l,merkleRoot:b,valid:h,showTrans:p}),r=c;case 18:d++,e.next=3;break;case 21:a({type:x.UPDATE_BLOCK,payload:{block:u}});case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){var t=Object(n.useContext)(y),a=t.state,r=t.dispatch,c=Object(n.useRef)(),s=Object(n.useState)(),l=Object(i.a)(s,2),o=l[0],u=l[1],d=Object(n.useState)(),b=Object(i.a)(d,2),x=b[0],h=b[1],p=Object(n.useState)(!1),g=Object(i.a)(p,2),N=g[0],T=g[1];function S(){return(S=Object(f.a)(O.a.mark((function t(){var n,s,i;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c.current=Math.round(1e6*Math.random()),T(!0),t.next=4,M(c.current,u,h,e.setSolution,e.setIsValid);case 4:if(n=t.sent,T(!1),s=e.chain,i=e.block,!s||!i){t.next=10;break}return t.next=10,J(a,r,i.index,i.prevHash,n,!0);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(j.jsxs)("div",{className:e.chain?"bordered-background":"col-11 col-lg-5 mx-3",children:[Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Nonce"})}),Object(j.jsx)(v.a.Control,{type:"number",defaultValue:e.solution?c.current:"",disabled:!0})]}),Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Header"})}),Object(j.jsx)(v.a.Control,{type:"number",defaultValue:o,disabled:!0})]}),Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Target"})}),Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",defaultValue:x,readOnly:!0})]}),Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Sol'n"})}),Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",style:{color:"".concat(e.isValid?"green":"red")},defaultValue:e.solution,readOnly:!0})]}),Object(j.jsx)(D.a,{variant:"primary",className:"btn-block d-block mt-2",disabled:e.isValid||!e.chain&&0===a.selectedTrans.length||N,onClick:function(){return function(){return S.apply(this,arguments)}()},children:Object(j.jsxs)("h4",{className:"my-1",children:["Mine",N&&Object(j.jsx)("span",{className:"position-absolute spinner-border spinner-border-md mx-4",role:"status"})]})})]})}function W(e){var t,a=e.block,c=Object(n.useContext)(y).dispatch,s=Object(n.useState)(""),l=Object(i.a)(s,2),o=l[0],u=l[1],d=Object(n.useState)(void 0),b=Object(i.a)(d,2),h=b[0],O=b[1],p=Object(n.useState)(null===(t=a.valid)||void 0===t||t),f=Object(i.a)(p,2),g=f[0],N=f[1];return Object(n.useEffect)((function(){O(a.timestamp)}),[a.timestamp]),Object(n.useEffect)((function(){void 0!==a.valid&&N(a.valid)}),[a.valid]),Object(n.useEffect)((function(){u(a.currHash)}),[a.currHash]),Object(j.jsx)("div",{className:"block flex-column flex-shrink-0",children:Object(j.jsxs)("div",{className:"my-3 mx-1 p-2 rounded "+(g?"valid-block":"invalid-block"),children:[Object(j.jsxs)(v.a,{children:[Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Index"})}),Object(j.jsx)(v.a.Control,{type:"number",defaultValue:a.index,disabled:!0})]}),Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Timestamp"})}),Object(j.jsx)(v.a.Control,{type:"number",defaultValue:null!==h&&void 0!==h?h:a.timestamp,disabled:!0},null!==h&&void 0!==h?h:a.timestamp)]}),Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Previous #"})}),Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",defaultValue:a.prevHash,readOnly:!0})]}),Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Current #"})}),Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",defaultValue:o||a.currHash,readOnly:!0},o||a.currHash)]}),Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Merkle #"})}),0===a.index?Object(j.jsx)(v.a.Control,{type:"text",defaultValue:"",disabled:!0}):Object(j.jsxs)(r.a.Fragment,{children:[Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",defaultValue:a.merkleRoot,readOnly:!0},a.merkleRoot),Object(j.jsx)(m.a.Append,{children:Object(j.jsx)(m.a.Text,{className:"show-trans-eye",onClick:function(){c({type:x.UPDATE_BLOCK,payload:{block:Object(A.a)(Object(A.a)({},a),{},{showTrans:!a.showTrans})}})},children:a.showTrans?"\ud83d\ude48":"\ud83d\ude49"})})]})]})]}),Object(j.jsx)(H,{chain:!0,block:a,solution:o,setSolution:u,isValid:g,setIsValid:N})]})})}var G=a(28),q=a(6),z=a(22),X=a(35),Y=a(36),Z=function(){function e(t){Object(X.a)(this,e),this.value=void 0,this.children=void 0,this.parent=void 0,this.pos=void 0,this.value=t,this.children=[],this.parent=null,this.pos={x:0,y:0}}return Object(Y.a)(e,[{key:"left",get:function(){return this.children[0]},set:function(e){e.parent=this,this.children[0]=e}},{key:"right",get:function(){return this.children[1]},set:function(e){e.parent=this,this.children[1]=e}},{key:"position",get:function(){return this.pos},set:function(e){this.pos=e}}]),e}(),Q=Object(z.a)("root"),$=Object(z.a)("transactionSignatures"),ee=Object(z.a)("startPosition"),te=Object(z.a)("dim"),ae=Object(z.a)("ctx"),ne=function(){function e(t,a){Object(X.a)(this,e),Object.defineProperty(this,Q,{writable:!0,value:void 0}),Object.defineProperty(this,$,{writable:!0,value:void 0}),Object.defineProperty(this,ee,{writable:!0,value:void 0}),Object.defineProperty(this,te,{writable:!0,value:void 0}),Object.defineProperty(this,ae,{writable:!0,value:void 0});var n=window.innerWidth<1200?1.8*window.innerWidth:window.innerWidth/2*.7;Object(q.a)(this,Q)[Q]=null,Object(q.a)(this,$)[$]=a.map((function(e){return e.signature.slice(0,25)+"..."})),Object(q.a)(this,ee)[ee]={x:n,y:5},Object(q.a)(this,ae)[ae]=t.getContext("2d"),Object(q.a)(this,te)[te]={width:t.width,height:t.height}}return Object(Y.a)(e,[{key:"calculatePosition",value:function(e){var t=e.x,a=e.y,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=50;return{x:n?t-6*r:t+6*r,y:a+r}}},{key:"clear",value:function(){Object(q.a)(this,ae)[ae]&&Object(q.a)(this,ae)[ae].clearRect(0,0,Object(q.a)(this,te)[te].width,Object(q.a)(this,te)[te].height)}},{key:"addNode",value:function(e){var t=new Z(""!==e?e.slice(0,25)+"...":"");if(Object(q.a)(this,Q)[Q])for(var a=Object(q.a)(this,Q)[Q];a;){if(!a.left){t.position=this.calculatePosition(a.position,!0),a.left=t;break}if(!a.right){t.position=this.calculatePosition(a.position),a.right=t;break}a=a.left.left&&a.left.right?a.right:a.left}else t.position=Object(q.a)(this,ee)[ee],Object(q.a)(this,Q)[Q]=t}},{key:"drawTree",value:function(){var e=this,t=[];for(t.push(Object(q.a)(this,Q)[Q]);0!==t.length;){var a=t.shift(),n=a&&9*a.value.length;Object(q.a)(this,ae)[ae]&&n&&a&&function(){var r,c=a.position,s=c.x,i=c.y;Object(q.a)(e,ae)[ae].beginPath(),Object(q.a)(e,ae)[ae].font="1rem Arial",Object(q.a)(e,ae)[ae].strokeStyle="#000";var l=Object(q.a)(e,$)[$].includes(a.value)?"#ddf":"#ff0a";Object(q.a)(e,ae)[ae].fillStyle=a.value===(null===(r=Object(q.a)(e,Q)[Q])||void 0===r?void 0:r.value)?"#dfd":l,Object(q.a)(e,ae)[ae].fillRect(s-n/2,i+5,n,30),Object(q.a)(e,ae)[ae].fillStyle="#000",Object(q.a)(e,ae)[ae].fillText(a.value,s+10-n/2,i+27),a.children.forEach((function(a,n){a.position.x=1===n?a.position.x-150:a.position.x+150,t.push(a),Object(q.a)(e,ae)[ae]&&(Object(q.a)(e,ae)[ae].beginPath(),Object(q.a)(e,ae)[ae].moveTo(s+.5,i+35),Object(q.a)(e,ae)[ae].lineTo(a.position.x+.5,a.position.y+5),Object(q.a)(e,ae)[ae].stroke())}))}()}}}]),e}();function re(e,t,a){return ce.apply(this,arguments)}function ce(){return(ce=Object(f.a)(O.a.mark((function e(t,a,n){var r,c,s,i,l,o,u;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[[""]],!(a.length>0)){e.next=26;break}c=t.map((function(e){return e.signature})),s=a.map((function(e){return e.signature})),i=c.filter((function(e){return s.includes(e)})),r=[i];case 6:if(1===i.length){e.next=26;break}l=[],o=0;case 9:if(!(o<i.length)){e.next=22;break}if(!i[o+1]){e.next=16;break}return e.next=13,w(i[o]+i[o+1]);case 13:e.t0=e.sent,e.next=17;break;case 16:e.t0=i[o];case 17:u=e.t0,l.push(u);case 19:o+=2,e.next=9;break;case 22:i=l,r.push(l),e.next=6;break;case 26:return n&&n(r),e.abrupt("return",se(r));case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e){return e[e.length-1][0]}function ie(e){var t=e.index,a=Object(n.useContext)(y),r=a.state,c=a.dispatch,s=Object(n.useState)(r.chain[t].transactions),l=Object(i.a)(s,2),o=l[0],u=l[1];function d(e,t,a){return b.apply(this,arguments)}function b(){return(b=Object(f.a)(O.a.mark((function e(a,n,s){var i,l,d,j,b;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=JSON.parse(JSON.stringify(o)))[n]=Object(A.a)(Object(A.a)({},i[n]),{},Object(G.a)({},s,a)),l=i[n].to+i[n].from+i[n].amount+i[n].message,e.next=5,w(l);case 5:return i[n].signature=e.sent,d=r.chain[t].prevHash,e.next=9,re(i,i);case 9:return j=e.sent,e.next=12,w(t+d+j);case 12:return b=e.sent,u(i),e.next=16,J(r,c,t,d,b,!1,j,i);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(j.jsx)("div",{className:"row flex-nowrap overflow-auto mx-2",children:o.map((function(e,t){var a;return Object(j.jsxs)("div",{className:"col-12 mr-2 bg-light border border-dark p-1 rounded",children:[Object(j.jsxs)(v.a.Group,{className:"mb-2 text-center",children:[Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",value:e.from,onChange:function(e){return d(e.target.value,t,"from")}}),Object(j.jsx)("h3",{className:"my-0",children:"\u2193"}),Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",value:e.to,onChange:function(e){return d(e.target.value,t,"to")}})]}),Object(j.jsxs)(m.a,{className:"mb-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Msg"})}),Object(j.jsx)(v.a.Control,{as:"textarea",rows:3,value:e.message,onChange:function(e){return d(e.target.value,t,"message")}})]}),Object(j.jsxs)(m.a,{className:"mb-2",children:[Object(j.jsx)(v.a.Control,{type:"number",value:null!==(a=e.amount)&&void 0!==a?a:0,onChange:function(e){return d(e.target.value,t,"amount")}}),Object(j.jsx)(m.a.Append,{children:Object(j.jsx)(m.a.Text,{children:"LC"})})]}),Object(j.jsxs)(m.a,{children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Sig"})}),Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",defaultValue:e.signature,readOnly:!0},e.signature)]})]},"sig:".concat(t))}))})}a(41);function le(){var e=Object(n.useContext)(y).state;return Object(j.jsx)("div",{className:"mx-3 row flex-nowrap overflow-auto",children:e.chain.map((function(e){return Object(j.jsxs)("div",{className:"block",children:[Object(j.jsx)(W,{block:e}),e.showTrans&&Object(j.jsx)(ie,{index:e.index})]},e.prevHash)}))})}function oe(){return Object(j.jsxs)("div",{children:[Object(j.jsx)(b,{}),Object(j.jsx)(le,{})]})}function ue(){var e=Object(n.useContext)(y),t=e.state,a=e.dispatch,r=Object(n.useRef)(null),c=Object(n.useState)(""),s=Object(i.a)(c,2),l=s[0],o=s[1],u=Object(n.useState)(!1),d=Object(i.a)(u,2),b=d[0],h=d[1],O=Object(n.useState)(Date.now()),p=Object(i.a)(O,2),f=p[0],g=p[1],N=Object(n.useState)([[""]]),T=Object(i.a)(N,2),S=T[0],k=T[1],w=Object(n.useState)(t.chain[t.chain.length-1].index+1),C=Object(i.a)(w,2),E=C[0],P=C[1],A=Object(n.useState)(t.chain[t.chain.length-1].currHash),R=Object(i.a)(A,2),V=R[0],_=R[1];return Object(n.useEffect)((function(){re(t.verifiedTrans,t.selectedTrans,k),h(!1)}),[t.selectedTrans,t.verifiedTrans]),Object(n.useEffect)((function(){!function(e,t,a){if(t){var n=new ne(t,a);n.clear();for(var r=function(e){for(var t=[],a=0;a<e.length;a++)t=t.concat(e[a].reverse());return t}(e),c=r.length-1;c>=0;c--)n.addNode(r[c]);n.drawTree()}}(S,r.current,t.selectedTrans)}),[S,t.selectedTrans]),Object(n.useEffect)((function(){return g(Date.now())}),[l]),Object(j.jsxs)("div",{className:"container-fluid row d-flex justify-content-center mx-auto my-3",children:[Object(j.jsxs)("div",{className:"mb-2 d-none d-lg-block",children:[Object(j.jsx)("h4",{className:"font-weight-bold text-center",children:"Merkle Tree Visualization"}),Object(j.jsx)("canvas",{ref:r,className:"border border-dark rounded",width:.7*window.outerWidth})]}),Object(j.jsx)(H,{chain:!1,solution:l,setSolution:o,isValid:b,setIsValid:h}),Object(j.jsxs)(v.a,{className:"col-10 col-lg-5 my-4 my-lg-0 pb-2 px-2 rounded "+(b?"valid-block":"invalid-block"),children:[Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Index"})}),Object(j.jsx)(v.a.Control,{type:"number",value:E,disabled:!0})]}),Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Timestamp"})}),Object(j.jsx)(v.a.Control,{type:"number",value:f,disabled:!0})]}),Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Previous #"})}),Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",value:V,readOnly:!0})]}),Object(j.jsxs)(m.a,{className:"my-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Current #"})}),Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",value:l,readOnly:!0})]}),Object(j.jsxs)(m.a,{className:"mt-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Merkle #"})}),Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",value:se(S),readOnly:!0})]}),b&&Object(j.jsx)(D.a,{className:"mt-2",variant:"success",block:!0,onClick:function(){return function(){var e={index:E,prevHash:V,currHash:l,transactions:t.selectedTrans,timestamp:f,merkleRoot:se(S),valid:t.chain[E-1].valid,showTrans:!1};a({type:x.ADD_BLOCK,payload:{block:e}}),a({type:x.UPDATE_VERIFIED_TRANS}),a({type:x.UPDATE_SELECTED_TRANS,payload:{selectedTrans:[]}}),h(!1),P(E+1),_(l),o(""),g(Date.now())}()},children:Object(j.jsx)("h4",{className:"my-0",children:"Add Block"})})]})]})}function de(){var e=Object(n.useContext)(y),t=e.state,a=e.dispatch;return Object(j.jsxs)("div",{className:"container-fluid",children:[Object(j.jsx)("h3",{className:"font-weight-bold",children:"Verified Transactions"}),Object(j.jsx)("div",{className:"trans-list row flex-nowrap overflow-auto bg-dark mx-1 px-2 rounded",children:t.verifiedTrans.map((function(e){return Object(j.jsxs)("div",{className:"trans-item "+(t.selectedTrans.map((function(e){return e.signature})).includes(e.signature)?"selected":"not-selected"),onClick:function(){return function(e){var n=JSON.parse(JSON.stringify(t)).selectedTrans,r=n.map((function(e){return e.signature})).includes(e.signature);n.length<4||r?(r?n=n.filter((function(t){return t.signature!==e.signature})):n.push(e),a({type:x.UPDATE_SELECTED_TRANS,payload:{selectedTrans:n}})):alert("You can mine at most 4 transactions at a time!")}(e)},children:[Object(j.jsxs)(v.a.Group,{className:"mb-2 text-center",children:[Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",defaultValue:e.from,readOnly:!0}),Object(j.jsx)("h3",{className:"my-0",children:"\u2193"}),Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",defaultValue:e.to,readOnly:!0})]}),Object(j.jsxs)(m.a,{className:"mb-2",children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Msg"})}),Object(j.jsx)(v.a.Control,{as:"textarea",defaultValue:e.message,readOnly:!0})]}),Object(j.jsxs)(m.a,{className:"mb-2",children:[Object(j.jsx)(v.a.Control,{type:"number",defaultValue:e.amount,disabled:!0}),Object(j.jsx)(m.a.Append,{children:Object(j.jsx)(m.a.Text,{children:"LC"})})]}),Object(j.jsxs)(m.a,{children:[Object(j.jsx)(m.a.Prepend,{children:Object(j.jsx)(m.a.Text,{children:"Sig"})}),Object(j.jsx)(v.a.Control,{className:"text-truncate",type:"text",defaultValue:e.signature,readOnly:!0})]})]},"sig:".concat(e.signature))}))})]})}function je(){return Object(j.jsxs)("div",{children:[Object(j.jsx)(b,{}),Object(j.jsx)(de,{}),Object(j.jsx)(ue,{})]})}function be(e){return JSON.parse(JSON.stringify(e))}var xe=function(e,t){switch(t.type){case x.ADD_VERIFIED_TRANS:var a=t.payload.trans,n=[].concat(Object(p.a)(e.verifiedTrans),[be(a)]);return localStorage.setItem("verTrans",JSON.stringify(n)),Object(A.a)(Object(A.a)({},e),{},{verifiedTrans:n});case x.UPDATE_VERIFIED_TRANS:var r=e.selectedTrans.map((function(e){return e.signature})),c=e.verifiedTrans.filter((function(e){return!r.includes(e.signature)}));return localStorage.setItem("verTrans",JSON.stringify(c)),Object(A.a)(Object(A.a)({},e),{},{verifiedTrans:c});case x.UPDATE_SELECTED_TRANS:var s=t.payload.selectedTrans;return localStorage.setItem("selTrans",JSON.stringify(s)),Object(A.a)(Object(A.a)({},e),{},{selectedTrans:s});case x.UPDATE_USERS:var i=t.payload.users;return localStorage.setItem("users",JSON.stringify(i)),Object(A.a)(Object(A.a)({},e),{},{users:i});case x.SET_MAIN_USER:var l=t.payload.user;return localStorage.setItem("user",JSON.stringify(l)),Object(A.a)(Object(A.a)({},e),{},{user:l});case x.ADD_BLOCK:var o=t.payload.block,u=[].concat(Object(p.a)(be(e.chain)),[o]);return localStorage.setItem("chain",JSON.stringify(u)),Object(A.a)(Object(A.a)({},e),{},{chain:u});case x.UPDATE_BLOCK:var d=t.payload.block,j=Array.isArray(d)?d:[d],b=be(e.chain);return j.forEach((function(e){return b[e.index]=be(e)})),localStorage.setItem("chain",JSON.stringify(b)),Object(A.a)(Object(A.a)({},e),{},{chain:b});default:return e}};a(60);function he(){var e,t,a,r,c,s=Object(n.useReducer)(xe,{verifiedTrans:null!==(e=JSON.parse(localStorage.getItem("verTrans")))&&void 0!==e?e:[],selectedTrans:null!==(t=JSON.parse(localStorage.getItem("selTrans")))&&void 0!==t?t:[],users:null!==(a=JSON.parse(localStorage.getItem("users")))&&void 0!==a?a:[],user:null!==(r=JSON.parse(localStorage.getItem("user")))&&void 0!==r?r:{},chain:null!==(c=JSON.parse(localStorage.getItem("chain")))&&void 0!==c?c:[{index:0,prevHash:"",currHash:new Array(64).fill("0").join(""),transactions:[],timestamp:Date.parse("04/31/2021"),merkleRoot:""}]}),u=Object(i.a)(s,2),d=u[0],b=u[1],x=Object(n.useMemo)((function(){return{state:d,dispatch:b}}),[d,b]);return Object(j.jsx)(l.a,{basename:"/LibraCoin",children:Object(j.jsxs)(y.Provider,{value:x,children:[Object(j.jsx)(o.b,{exact:!0,path:"/",children:Object(j.jsx)(o.a,{to:"/wallet"})}),Object(j.jsx)(o.b,{path:"/wallet",component:K}),Object(j.jsx)(o.b,{path:"/mine",component:je}),Object(j.jsx)(o.b,{path:"/blockchain",component:oe})]})})}a(64);s.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(he,{})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.781ac96d.chunk.js.map