(this.webpackJsonplibracoin=this.webpackJsonplibracoin||[]).push([[0],{17:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return k}));var r=n(0),a=n.n(r),i=n(2),s=n(10),c=n(4),o=n.n(c),u=n(9),h=n.n(u),l=n(3),f=n(7),b=n(1),p=n(5),d=function e(t,n,r,a){Object(l.a)(this,e),this.index=void 0,this.prevHash=void 0,this.currHash=void 0,this.transactions=void 0,this.timestamp=Date.now(),this.index=t,this.prevHash=n,this.currHash=r,this.transactions=a},y=function e(t,n,r,a){Object(l.a)(this,e),this.amount=void 0,this.from=void 0,this.to=void 0,this.message=void 0,this.amount=t,this.from=n,this.to=r,this.message=a},v=Object(p.a)("chain"),g=Object(p.a)("verifiedTransactions"),j=Object(p.a)("BLOCK_LIMIT"),w=function(){function e(){Object(l.a)(this,e),Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,g,{writable:!0,value:void 0}),Object.defineProperty(this,j,{writable:!0,value:2});var t={type:"public",extractable:!0,algorithm:{name:"ECDSA"},usages:["verify"]},n=[new y(0,t,t)],r=Array(64).fill("0").join(""),a=this.randomHash(32).replace(/^.{0,3}/,"000");Object(b.a)(this,v)[v]=[new d(0,r,a,n)],Object(b.a)(this,g)[g]=[]}return Object(f.a)(e,[{key:"blockChain",get:function(){return Object(b.a)(this,v)[v]}},{key:"lastBlock",get:function(){return Object(b.a)(this,v)[v][Object(b.a)(this,v)[v].length-1]}},{key:"randomHash",value:function(t){return e.bufferToHex(window.crypto.getRandomValues(new Uint32Array(t)))}},{key:"digestMessage",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(new TextEncoder).encode(t),e.next=3,window.crypto.subtle.digest("SHA-256",n);case 3:return r=e.sent,i=Array.from(new Uint8Array(r)),s=i.map((function(e){return e.toString(16).padStart(2,"0")})).join(""),e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"mine",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("\u2692 mining..."),r="";case 2:if(!(t<=Number.MAX_SAFE_INTEGER)){e.next=13;break}return e.next=5,this.digestMessage(t.toString());case 5:if(r=e.sent,!r.substr(0,n).split("").every((function(e){return"0"===e}))){e.next=10;break}return console.log("Solved: ".concat(t)),e.abrupt("break",13);case 10:t++,e.next=2;break;case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"verifyTransaction",value:function(){var t=Object(i.a)(a.a.mark((function t(n,r){var i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.stringToArrayBuffer(JSON.stringify(n)),t.next=3,crypto.subtle.verify({name:"ECDSA",hash:"SHA-256"},n.from,r,i);case 3:if(t.sent&&(Object(b.a)(this,g)[g].push(n),console.log("\u2705 Verified Transaction!"),console.log("Transaction Pool Now Has ".concat(Object(b.a)(this,g)[g].length," Verified Transactions"))),Object(b.a)(this,g)[g].length!==Object(b.a)(this,j)[j]){t.next=9;break}return t.next=8,this.addBlock(Object(b.a)(this,g)[g]);case 8:Object(b.a)(this,g)[g]=[];case 9:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"addBlock",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,s,c,o,u,h,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Math.round(2*Math.random())+2,e.next=3,this.digestMessage(this.randomHash(20));case 3:r=e.sent,i=new RegExp("^.{0,".concat(n,"}"),"g"),s=Array(n).fill("0").join(""),c=r.replace(i,s),o=!1;case 8:if(o){e.next=16;break}return u=Math.round(999999999*Math.random()),e.next=12,this.mine(u,n);case 12:(h=e.sent)<=c?(l=new d(this.lastBlock.index+1,this.lastBlock.currHash,h,t),Object(b.a)(this,v)[v].push(l),console.log("\u2728 Added Block To Chain"),o=!0):console.log("\u274c Failed Mining Below Target"),e.next=8;break;case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"stringToArrayBuffer",value:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,a=e.length;r<a;r++)n[r]=e.charCodeAt(r);return t}},{key:"bufferToHex",value:function(e){return Array.from(new Uint8Array(e)).map((function(e){return e.toString(16).padStart(2,"0")})).join("")}}]),e}();w.instance=new w;var m=Object(p.a)("privateKey"),x=function(){function e(){Object(l.a)(this,e),this.publicKey={type:"public",extractable:!0,algorithm:{name:"ECDSA"},usages:["verify"]},Object.defineProperty(this,m,{writable:!0,value:{type:"private",extractable:!0,algorithm:{name:"ECDSA"},usages:["sign"]}})}return Object(f.a)(e,[{key:"initialize",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]);case 2:t=e.sent,this.publicKey=t.publicKey,Object(b.a)(this,m)[m]=t.privateKey;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getMessageEncoding",value:function(e){return(new TextEncoder).encode(e)}},{key:"sendMoney",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new y(t,this.publicKey,n,r),s=w.stringToArrayBuffer(JSON.stringify(i)),e.next=4,window.crypto.subtle.sign({name:"ECDSA",hash:"SHA-256"},Object(b.a)(this,m)[m],s);case 4:return c=e.sent,e.next=7,w.instance.verifyTransaction(i,c);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),e}(),O=n(6);function k(){var e=Object(c.useState)(),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(c.useEffect)((function(){function e(){return(e=Object(i.a)(a.a.mark((function e(){var t,n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new x,e.next=3,t.initialize();case 3:return n=new x,e.next=6,n.initialize();case 6:return i=new x,e.next=9,i.initialize();case 9:return console.log("A"),e.next=12,t.sendMoney(1e3,n.publicKey,"Good dog gets money");case 12:return e.next=14,i.sendMoney(1e6,n.publicKey,"Be rich Bamba");case 14:return e.next=16,i.sendMoney(10,t.publicKey,"You deserve this much");case 16:return e.next=18,t.sendMoney(1,i.publicKey,"Thank you");case 18:return e.next=20,n.sendMoney(1,t.publicKey,"I am rich \ud83d\ude00\ud83d\udc36");case 20:return e.next=22,t.sendMoney(1,n.publicKey);case 22:console.log("HERE"),r(w.instance.blockChain);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(O.jsx)("div",{children:Object(O.jsx)("pre",{children:JSON.stringify(n,null,2)})})}h.a.render(Object(O.jsx)(o.a.StrictMode,{children:Object(O.jsx)(k,{})}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.bf0ea262.chunk.js.map